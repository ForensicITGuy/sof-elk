# SOF-ELK® Configuration File
# (C)2023 Lewes Technology Consulting, LLC
#
# This file creates filebeats prospector for Zeek source data from the SOF-ELK® VM itself

- type: log
  paths:
    - /logstash/zeek/**/conn.*
  exclude_files: [ '\.gz$', '\.bz2$', '\.zip$' ]
  close_inactive: 5m
  fields_under_root: true
  fields:
    type: zeek_conn
  tags: [ 'zeek' ]

- type: log
  paths:
    - /logstash/zeek/**/dns.*
  exclude_files: [ '\.gz$', '\.bz2$', '\.zip$' ]
  close_inactive: 5m
  fields_under_root: true
  fields:
    type: zeek_dns
  tags: [ 'zeek' ]

- type: log
  paths:
    - /logstash/zeek/**/http.*
  exclude_files: [ '\.gz$', '\.bz2$', '\.zip$' ]
  close_inactive: 5m
  fields_under_root: true
  fields:
    type: zeek_http
  tags: [ 'zeek' ]

- type: log
  paths:
    - /logstash/zeek/**/files.*
  exclude_files: [ '\.gz$', '\.bz2$', '\.zip$' ]
  close_inactive: 5m
  fields_under_root: true
  fields:
    type: zeek_files
  tags: [ 'zeek' ]

- type: log
  paths:
    - /logstash/zeek/**/ssl.*
  exclude_files: [ '\.gz$', '\.bz2$', '\.zip$' ]
  close_inactive: 5m
  fields_under_root: true
  fields:
    type: zeek_ssl
  tags: [ 'zeek' ]

- type: log
  paths:
    - /logstash/zeek/**/x509.*
  exclude_files: [ '\.gz$', '\.bz2$', '\.zip$' ]
  close_inactive: 5m
  fields_under_root: true
  fields:
    type: zeek_x509
  tags: [ 'zeek' ]

- type: log
  paths:
    - /logstash/zeek/**/ftp.*
  exclude_files: [ '\.gz$', '\.bz2$', '\.zip$' ]
  close_inactive: 5m
  fields_under_root: true
  fields:
    type: zeek_ftp
  tags: [ 'zeek' ]

- type: log
  paths:
    - /logstash/zeek/**/notice.*
  exclude_files: [ '\.gz$', '\.bz2$', '\.zip$' ]
  close_inactive: 5m
  fields_under_root: true
  fields:
    type: zeek_notice
  tags: [ 'zeek' ]

- type: log
  paths:
    - /logstash/zeek/**/weird.*
  exclude_files: [ '\.gz$', '\.bz2$', '\.zip$' ]
  close_inactive: 5m
  fields_under_root: true
  fields:
    type: zeek_weird
  tags: [ 'zeek' ]

- type: log
  paths:
    - /logstash/zeek/**/dhcp.*
  exclude_files: [ '\.gz$', '\.bz2$', '\.zip$' ]
  close_inactive: 5m
  fields_under_root: true
  fields:
    type: zeek_dhcp
  tags: [ 'zeek' ]

- type: log
  paths:
    - /logstash/zeek/**/dpd.*
  exclude_files: [ '\.gz$', '\.bz2$', '\.zip$' ]
  close_inactive: 5m
  fields_under_root: true
  fields:
    type: zeek_dpd
  tags: [ 'zeek' ]

- type: log
  paths:
    - /logstash/zeek/**/irc.*
  exclude_files: [ '\.gz$', '\.bz2$', '\.zip$' ]
  close_inactive: 5m
  fields_under_root: true
  fields:
    type: zeek_irc
  tags: [ 'zeek' ]
